<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Safe Bank</title>
</head>
<body>
    <h1>Bank</h1>
    <a href="http://localhost:10002/xsrf" target="_blank">Be dumb and click the link</a>

    <script>
        var login = new XMLHttpRequest();
        login.open('GET', '/xsrf/login', true);

        login.onload = function() {
          if (login.status >= 200 && login.status < 400) {
            var resp = login.responseText;

            alert("Logged in")

            getAccDetails()
          }
        };

        login.onerror = function(e) {
            console.error('[RequestError]', e)
        };

        login.send();

        function getAccDetails() {
            var request = new XMLHttpRequest();
            request.open('GET', '/xsrf/account', true);
            request.onload = function() {
                if (request.status >= 200 && request.status < 400) {
                    console.log(JSON.parse(resp))
                }
            };

            request.send()
        }
    </script>
</body>
</html>